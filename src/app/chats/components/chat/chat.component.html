<div *ngIf="load">
  <app-loader></app-loader>
</div>

<div class="flex flex-col flex-grow gap-4 mb-4 overflow-y-auto scrollbar-w-2 scrollbar-track-lighter scrollbar-thumb scrollbar-thumb-rounded">
  <div class="flex items-center pb-4 border-b">
    <img *ngIf="chatUser.image; else default" src="" class="rounded-full w-12 h-12 object-cover mr-4">
    <ng-template #default>
        <svg class="w-10 mr-3" fill="#f3f4f6" viewBox="-8.96 -8.96 81.92 81.92" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linejoin:round;stroke-miterlimit:2;" stroke="#f3f4f6" stroke-width="0.00064"><g id="SVGRepo_bgCarrier" stroke-width="0"><path transform="translate(-8.96, -8.96), scale(5.12)" fill="#ea580c" d="M9.166.33a2.25 2.25 0 00-2.332 0l-5.25 3.182A2.25 2.25 0 00.5 5.436v5.128a2.25 2.25 0 001.084 1.924l5.25 3.182a2.25 2.25 0 002.332 0l5.25-3.182a2.25 2.25 0 001.084-1.924V5.436a2.25 2.25 0 00-1.084-1.924L9.166.33z" strokewidth="0"></path></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"> <g transform="matrix(1,0,0,1,-1216,-192)"> <rect id="Icons" x="0" y="0" width="1280" height="800" style="fill:none;"></rect> <g id="Icons1" serif:id="Icons"> <g id="Strike"> </g> <g id="H1"> </g> <g id="H2"> </g> <g id="H3"> </g> <g id="list-ul"> </g> <g id="hamburger-1"> </g> <g id="hamburger-2"> </g> <g id="list-ol"> </g> <g id="list-task"> </g> <g id="trash"> </g> <g id="vertical-menu"> </g> <g id="horizontal-menu"> </g> <g id="sidebar-2"> </g> <g id="Pen"> </g> <g id="Pen1" serif:id="Pen"> </g> <g id="clock"> </g> <g id="external-link"> </g> <g id="hr"> </g> <g id="info"> </g> <g id="warning"> </g> <g id="plus-circle"> </g> <g id="minus-circle"> </g> <g id="vue"> </g> <g id="cog"> </g> <g id="logo"> </g> <g id="radio-check"> </g> <g id="eye-slash"> </g> <g id="eye"> </g> <g id="toggle-off"> </g> <g id="shredder"> </g> <g id="spinner--loading--dots-" serif:id="spinner [loading, dots]"> </g> <g id="react"> </g> <g id="check-selected"> </g> <g id="turn-off"> </g> <g id="code-block"> </g> <g id="user" transform="matrix(1.03318,0,0,1.03318,-20.8457,199.979)"> <g transform="matrix(0.909091,0,0,0.909091,1182.28,-18.6364)"> <path d="M50,46.5C42.8,46.5 37,40.7 37,33.5C37,26.3 42.8,20.5 50,20.5C57.2,20.5 63,26.3 63,33.5C63,40.7 57.2,46.5 50,46.5ZM50,24.5C45,24.5 41,28.5 41,33.5C41,38.5 45,42.5 50,42.5C55,42.5 59,38.5 59,33.5C59,28.5 55,24.5 50,24.5Z" style="fill-rule:nonzero;"></path> </g> <g transform="matrix(1,0,0,1,1177.7,-20.5)"> <path d="M34.036,58.5L34.036,67L30.4,67L30.4,58.5C30.4,51.318 39.218,45.773 50.4,45.773C61.582,45.773 70.4,51.318 70.4,58.5L70.4,67L66.764,67L66.764,58.5C66.764,53.591 59.309,49.409 50.4,49.409C41.491,49.409 34.036,53.591 34.036,58.5Z" style="fill-rule:nonzero;"></path> </g> </g> <g id="coffee-bean"> </g> <g transform="matrix(0.638317,0.368532,-0.368532,0.638317,785.021,-208.975)"> <g id="coffee-beans"> <g id="coffee-bean1" serif:id="coffee-bean"> </g> </g> </g> <g id="coffee-bean-filled"> </g> <g transform="matrix(0.638317,0.368532,-0.368532,0.638317,913.062,-208.975)"> <g id="coffee-beans-filled"> <g id="coffee-bean2" serif:id="coffee-bean"> </g> </g> </g> <g id="clipboard"> </g> <g transform="matrix(1,0,0,1,128.011,1.35415)"> <g id="clipboard-paste"> </g> </g> <g id="clipboard-copy"> </g> <g id="Layer1"> </g> </g> </g> </g></svg>
    </ng-template>
    <span class="text-lg font-medium">{{ chatUser.username }}</span>
  </div>
  <div class="flex flex-col flex-grow gap-4 overflow-y-auto scrollbar-w-2 scrollbar-track-lighter scrollbar-thumb scrollbar-thumb-rounded" id="scrollToBottom">
    <div *ngFor="let message of messages" class="pr-4">
      <div class="flex gap-1" [ngClass]="{'justify-end': message.user.id === authUser.id}">
        <div class="bg-gray-200 rounded-lg px-4 py-2" [ngClass]="{'bg-orange-500 bg-opacity-40': message.user.id === authUser.id}">
          <p class="flex text-sm text-gray-700" [ngClass]="{'justify-end': message.user.id === authUser.id}">{{ message.message }}</p>
          <p class="flex text-gray-400 date" [ngClass]="{'justify-end': message.user.id === authUser.id}">{{ message.date ?? message.created_at | date: 'HH:mm':'GMT+2' }}</p>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="px-4 pt-4 border-t">
  <form (submit)="submit()" autocomplete="off">
    <input class="w-full border rounded-full py-2 px-4 outline-orange-400" name="msg" type="text" placeholder="Escribe un mensaje..." [(ngModel)]="msg">
  </form>
</div>